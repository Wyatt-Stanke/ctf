<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CTF Challenge: Pipeline Exposure</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Source+Serif+4:ital,wght@0,400;0,600;1,400&display=swap"
      rel="stylesheet"
    />
    <style>
      *,
      *::before,
      *::after {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      :root {
        --bg: #0c0e13;
        --surface: #13161d;
        --surface-2: #1a1e27;
        --border: #2a2f3a;
        --text: #c8cdd8;
        --text-dim: #6b7280;
        --accent: #e05a33;
        --accent-glow: #e05a3344;
        --yellow: #fbbf24;
      }

      body {
        font-family: "Source Serif 4", Georgia, serif;
        background: var(--bg);
        color: var(--text);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        padding: 60px 20px;
        line-height: 1.7;
      }

      .container {
        max-width: 680px;
        width: 100%;
      }

      .difficulty {
        display: inline-block;
        font-family: "JetBrains Mono", monospace;
        font-size: 11px;
        font-weight: 700;
        letter-spacing: 2px;
        text-transform: uppercase;
        color: var(--accent);
        background: var(--accent-glow);
        padding: 4px 12px;
        border-radius: 3px;
        margin-bottom: 16px;
      }

      h1 {
        font-family: "JetBrains Mono", monospace;
        font-size: 28px;
        font-weight: 700;
        color: #f0f2f6;
        margin-bottom: 8px;
        line-height: 1.3;
      }

      .briefing {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: 8px;
        padding: 32px;
        margin-bottom: 32px;
      }

      .briefing p {
        font-size: 17px;
        margin-bottom: 16px;
      }

      .briefing p:last-child {
        margin-bottom: 0;
      }

      .notes {
        background: var(--surface-2);
        border-left: 3px solid var(--accent);
        border-radius: 6px;
        padding: 20px 24px;
        margin-bottom: 32px;
      }

      .notes-title {
        font-family: "JetBrains Mono", monospace;
        font-size: 12px;
        font-weight: 700;
        letter-spacing: 1.5px;
        text-transform: uppercase;
        color: var(--accent);
        margin-bottom: 10px;
      }

      .notes p {
        font-size: 15px;
        color: var(--text);
        line-height: 1.6;
      }

      .flag-format {
        font-family: "JetBrains Mono", monospace;
        font-size: 13px;
        color: var(--text-dim);
        background: var(--surface-2);
        padding: 8px 14px;
        border-radius: 4px;
        display: inline-block;
        margin-top: 8px;
      }

      .target-link {
        display: block;
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: 8px;
        padding: 20px 28px;
        margin-bottom: 40px;
        text-decoration: none;
        transition:
          border-color 0.2s,
          box-shadow 0.2s;
      }

      .target-link:hover {
        border-color: var(--accent);
        box-shadow: 0 0 20px var(--accent-glow);
      }

      .target-label {
        font-family: "JetBrains Mono", monospace;
        font-size: 11px;
        letter-spacing: 2px;
        text-transform: uppercase;
        color: var(--text-dim);
        margin-bottom: 6px;
      }

      .target-url {
        font-family: "JetBrains Mono", monospace;
        font-size: 15px;
        color: var(--accent);
      }

      .hints-section h2 {
        font-family: "JetBrains Mono", monospace;
        font-size: 14px;
        font-weight: 500;
        letter-spacing: 1px;
        text-transform: uppercase;
        color: var(--text-dim);
        margin-bottom: 16px;
      }

      .hint {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: 8px;
        margin-bottom: 12px;
        overflow: hidden;
      }

      .hint-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 16px 24px;
        cursor: pointer;
        user-select: none;
        transition: background 0.15s;
      }

      .hint-header:hover {
        background: var(--surface-2);
      }

      .hint-title {
        font-family: "JetBrains Mono", monospace;
        font-size: 14px;
        font-weight: 500;
        color: #f0f2f6;
      }

      .hint-toggle {
        font-family: "JetBrains Mono", monospace;
        font-size: 12px;
        color: var(--yellow);
        background: none;
        border: 1px solid var(--yellow);
        border-radius: 4px;
        padding: 3px 10px;
        cursor: pointer;
        transition:
          background 0.15s,
          color 0.15s;
        flex-shrink: 0;
        margin-left: 16px;
      }

      .hint-toggle:hover {
        background: var(--yellow);
        color: var(--bg);
      }

      .hint-body {
        max-height: 0;
        overflow: hidden;
        transition:
          max-height 0.35s ease,
          padding 0.35s ease;
      }

      .hint-body.revealed {
        max-height: 300px;
      }

      .hint-body-inner {
        padding: 0 24px 20px 24px;
        font-size: 16px;
        font-style: italic;
        color: var(--yellow);
        opacity: 0.9;
      }

      .warning {
        font-family: "JetBrains Mono", monospace;
        font-size: 11px;
        color: var(--text-dim);
        text-align: center;
        margin-top: 32px;
        opacity: 0.5;
      }

      .inline-code {
        font-family: "JetBrains Mono", monospace;
        font-size: 13px;
        background: var(--surface);
        padding: 2px 6px;
        border-radius: 3px;
      }

      blockquote {
        border-left: 3px solid var(--accent);
        padding-left: 16px;
        margin: 16px 0;
        color: var(--text-dim);
        font-style: italic;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="difficulty">Medium</div>
      <h1>Pipeline</h1>

      <div class="briefing">
        <p>
          NimbusOps is a cloud infrastructure AI-enabled management SAAS
          analytics e-commerce platform that also sells coffee. Last November,
          during a load balancer outage, their DevOps lead Marina Santiago
          suggested and created a status page to allow for the dev team to be
          able to more easily monitor the health of their services. It's a
          simple status page, deployed automatically to their web server via a
          self-hosted GHES GitHub Actions pipeline whenever someone pushes to
          <code>main</code>.
          <br />
          <br />
          The deployment pipeline authenticates to NimbusOps' private container
          registry using a secret key, stored as a GitHub Actions secret. If you had it, 
          you'd have access to every container image NimbusOps has ever shipped, including
          their internal tools, backend code, and even their proprietary coffee blend recipes.
          <br />
          <br />
          Santiago's been pretty confident about the pipeline's security. From a
          recent internal audit report that we were able to get our hands on,
          <br />
          <blockquote>
            "All pipeline secrets are stored using encrypted secret management
            and are automatically redacted in job output logs. A manual review
            of all historical build and deploy logs confirmed no instances of
            secret exposure. CI/CD secret handling is compliant with internal
            security policy. Self-hosting has not introduced any additional risks
            compared to GitHub's SAAS."
            <br />
            - NimbusOps Internal Security Audit, December 2024
          </blockquote>
          They're right. We haven't been able to find
          anything in what's already out there. But the status page was thrown
          together during an active incident, and things built in a rush have a
          way of leaving doors open that nobody thought to check.
        </p>
        <p>Find the deploy key (flag).</p>
        <div class="flag-format">Flag format: flag{...}</div>
      </div>

      <div class="notes">
        <div class="notes-title">‚ö† Important Note</div>
        <p>
          This challenge is hosted on GitHub Pages, but everything you need can
          be accessed through the hosted site only. Looking at the source code
          of the GitHub repository would be cheating. The challenge is meant to
          be solved through the hosted site only. No cheating!
        </p>
      </div>

      <div class="notes">
        <div class="notes-title">
          üóÅ Less Important But Still Pretty Important Note
        </div>
        <p>
          This
          <code class="inline-code">/challenge</code>
          page and anything under it is just a static page with the briefing,
          notes, and hints. None of the actual challenge content lives under
          this path. Your investigation starts at the target link above. Good
          luck detective.
        </p>
      </div>

      <a class="target-link" href="../" target="_blank">
        <div class="target-label">Target</div>
        <div class="target-url">NimbusOps Status Page ‚Üí</div>
      </a>

      <div class="hints-section">
        <h2>Hints</h2>

        <div class="hint">
          <div class="hint-header" onclick="_toggleHint(this)">
            <span class="hint-title">Hint 1</span>
            <button class="hint-toggle">Reveal</button>
          </div>
          <div class="hint-body">
            <div class="hint-body-inner">
              "Good engineers tell crawlers where not to go. And sometimes the data the page loads has more in it than the page bothers to render."
            </div>
          </div>
        </div>

        <div class="hint">
          <div class="hint-header" onclick="_toggleHint(this)">
            <span class="hint-title">Hint 2</span>
            <button class="hint-toggle">Reveal</button>
          </div>
          <div class="hint-body">
            <div class="hint-body-inner">
              "The pipeline can be triggered manually, and it accepts more inputs than you might expect. Read the workflow configuration carefully."
            </div>
          </div>
        </div>

        <div class="hint">
          <div class="hint-header" onclick="_toggleHint(this)">
            <span class="hint-title">Hint 3</span>
            <button class="hint-toggle">Reveal</button>
          </div>
          <div class="hint-body">
            <div class="hint-body-inner">
              "The build has safety checks that will stop you early if things look wrong. You need the pipeline to get far enough to write the auth
              file before it fails. Think about which checks you can skip and which you need to satisfy."
            </div>
          </div>
        </div>
      </div>

      <p class="warning">
        Think hard dad! Don't use hints unless you are 100% sure you have to.
        Maybe even sleep on it!
      </p>
    </div>

    <script>
      function _toggleHint(header) {
        const body = header.nextElementSibling;
        const btn = header.querySelector(".hint-toggle");
        const isRevealed = body.classList.contains("revealed");

        if (!isRevealed) {
          if (!body.dataset.confirmed) {
            btn.textContent = "Sure?";
            body.dataset.confirmed = "pending";
            return;
          }
          if (body.dataset.confirmed === "pending") {
            btn.textContent = "Really sure?";
            body.dataset.confirmed = "confirm-again";
            return;
          }
          body.classList.add("revealed");
          btn.textContent = "Hide";
          body.dataset.confirmed = "done";
        } else {
          body.classList.remove("revealed");
          btn.textContent = "Reveal";
          delete body.dataset.confirmed;
        }
      }
    </script>
  </body>
</html>
